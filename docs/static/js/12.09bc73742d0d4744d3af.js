webpackJsonp([12],{MYfb:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c=a("Xxa5"),i=a.n(c),s=a("exGp"),o=a.n(s),n=a("Dd8w"),r=a.n(n),d=a("P7/f"),u=a("44dg"),l=a("+48N"),p=a("hhm8"),h=a("i84Q"),f=a("NYxO"),m={data:function(){return{imageHost:"",cartProductVoList:[],recommendList:[],cartTotalPrice:0,allChecked:!1,startX:0,endX:0,deleteProductId:0,popupTitle:"",popupShow:!1,isLoading:!0}},beforeCreate:function(){var t=this;Object(h.h)().then(function(e){1!==e.status||t.$router.push("./login")})},created:function(){this.getCartList()},mounted:function(){var t=this;this.$nextTick(function(){setTimeout(function(){t.isLoading=!1},500)})},methods:r()({},Object(f.b)(["RECORE_FOOT"]),{getCartList:function(){var t=this;return o()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.f)().then(function(e){t.setConfig(e.data.imageHost,e.data.cartProductVoList,e.data.cartTotalPrice,e.data.allChecked)});case 2:t.getRecommendList();case 3:case"end":return e.stop()}},e,t)}))()},selectProduct:function(t,e){var a=this;return o()(i.a.mark(function c(){return i.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(parseInt(t.currentTarget.getAttribute("data-selected"))){c.next=6;break}return c.next=4,Object(h.v)(e).then(function(t){a.setConfig(t.data.imageHost,t.data.cartProductVoList,t.data.cartTotalPrice,t.data.allChecked)});case 4:c.next=8;break;case 6:return c.next=8,Object(h.y)(e).then(function(t){a.setConfig(t.data.imageHost,t.data.cartProductVoList,t.data.cartTotalPrice,t.data.allChecked)});case 8:a.getCartList();case 9:case"end":return c.stop()}},c,a)}))()},getRecommendList:function(){var t=this;Object(h.t)({keyword:"1",pageNum:1,pageSize:6,orderBy:"default"}).then(function(e){t.recommendList=e.data.list})},selectAll:function(){var t=this;this.allChecked?Object(h.x)().then(function(e){t.setConfig(e.data.imageHost,e.data.cartProductVoList,e.data.cartTotalPrice,e.data.allChecked)}):Object(h.u)().then(function(e){t.setConfig(e.data.imageHost,e.data.cartProductVoList,e.data.cartTotalPrice,e.data.allChecked)})},addCount:function(t,e,a){var c=this;e!==a?(e++,Object(h.A)(t,e).then(function(t){c.setConfig(t.data.imageHost,t.data.cartProductVoList,t.data.cartTotalPrice,t.data.allChecked)})):alert("超过该商品的库存量")},reduceCount:function(t,e){var a=this;1!==e?(e--,Object(h.A)(t,e).then(function(t){a.setConfig(t.data.imageHost,t.data.cartProductVoList,t.data.cartTotalPrice,t.data.allChecked)})):alert("该商品1件起售")},showDetail:function(t,e){console.log(t.currentTarget.className),console.log(e)},setConfig:function(t,e,a,c){this.imageHost=t,this.cartProductVoList=e,this.cartTotalPrice=a,this.allChecked=c},touchStart:function(t){this.startX=t.touches[0].clientX},touchEnd:function(t){var e=t.currentTarget.parentElement;this.endX=t.changedTouches[0].clientX,0==e.dataset.type&&this.startX-this.endX>30&&(this.resetSlide(),e.dataset.type=1),1==e.dataset.type&&this.startX-this.endX<-30&&(this.resetSlide(),e.dataset.type=0),this.startX=0,this.endX=0},resetSlide:function(){for(var t=document.querySelectorAll(".shopcart-item"),e=0;e<t.length;e++)t[e].dataset.type=0},deleteShopcart:function(t){this.deleteProductId=t,this.popupTitle="确定删除该商品吗？",this.popupShow=!0,ModalHelper.afterOpen()},settleAccounts:function(){this.cartTotalPrice&&this.$router.push("/order")},productDetail:function(t,e){var a=this;return o()(i.a.mark(function c(){var s;return i.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(s=Object(p.d)("footprintList"),"I"!==t.target.tagName){c.next=6;break}return c.next=4,Object(h.b)(a.recommendList[e].id,1).then(function(){});case 4:return a.getCartList(),c.abrupt("return");case 6:s.unshift(a.recommendList[e]),a.RECORE_FOOT(Object(p.b)(s)),a.$router.push("./product/"+a.recommendList[e].id);case 9:case"end":return c.stop()}},c,a)}))()},confirmPopup:function(){var t=this;Object(h.i)(this.deleteProductId).then(function(e){t.setConfig(e.data.imageHost,e.data.cartProductVoList,e.data.cartTotalPrice,e.data.allChecked)}),this.cancelPopup()},cancelPopup:function(){ModalHelper.beforeClose(),this.popupShow=!1,this.resetSlide()},goBack:function(){this.$router.go(-1)}}),components:{navBar:d.a,loading:u.a,popup:l.a}},v={render:function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("div",{staticClass:"shopcart-box"},[c("header",{staticClass:"user-head"},[c("i",{staticClass:"iconfont icon-left",on:{click:t.goBack}}),t._v(" "),c("span",[t._v("购物车")]),t._v(" "),c("i",{staticClass:"iconfont icon-More"})]),t._v(" "),c("loading",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],attrs:{"loading-type":2}}),t._v(" "),c("section",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}]},[c("section",{staticClass:"shopcart-page"},[c("div",{staticClass:"shopcart-list"},t._l(t.cartProductVoList,function(e){return c("div",{staticClass:"shopcart-item",attrs:{"data-type":"0"},on:{click:function(a){t.showDetail(a,e.productId)}}},[c("div",{staticClass:"shopcart-item-box",on:{"!touchstart":function(e){return t.touchStart(e)},"!touchend":function(e){return t.touchEnd(e)}}},[c("div",{staticClass:"shopcart-item-select"},[e.productChecked?c("i",{staticClass:"iconfont icon-duigou",attrs:{"data-selected":"1"},on:{click:function(a){t.selectProduct(a,e.productId)}}}):c("i",{staticClass:"iconfont icon-weibiaoti38",attrs:{"data-selected":"0"},on:{click:function(a){t.selectProduct(a,e.productId)}}})]),t._v(" "),e.productMainImage?c("img",{attrs:{src:t.imageHost+e.productMainImage}}):c("img",{attrs:{src:a("dlqP")}}),t._v(" "),c("div",{staticClass:"shopcart-item-info"},[c("p",{staticClass:"shopcart-name",domProps:{textContent:t._s(e.productName)}}),t._v(" "),c("p",{staticClass:"shopcart-subtitle",domProps:{textContent:t._s(e.productSubtitle)}}),t._v(" "),c("div",{staticClass:"shopcart-num"},[c("span",{staticClass:"shopcart-price",domProps:{textContent:t._s("￥"+e.productPrice)}}),t._v(" "),c("div",{staticClass:"shopcart-quantity"},[c("i",{class:{active:1===e.quantity},on:{click:function(a){t.reduceCount(e.productId,e.quantity,e.productStock)}}},[t._v("-")]),t._v(" "),c("span",[t._v(t._s(e.quantity))]),t._v(" "),c("i",{class:{active:e.quantity===e.productStock},on:{click:function(a){t.addCount(e.productId,e.quantity)}}},[t._v("+")])])])])]),t._v(" "),c("div",{staticClass:"delete",on:{click:function(a){t.deleteShopcart(e.productId)}}},[t._v("删除")])])})),t._v(" "),t.cartProductVoList.length>0?c("div",{staticClass:"shopcart-footer"},[c("div",{staticClass:"shopcart-item-select",on:{click:t.selectAll}},[!0===t.allChecked&&t.cartProductVoList.length?c("i",{staticClass:"iconfont icon-duigou"}):c("i",{staticClass:"iconfont icon-weibiaoti38"}),t._v(" "),c("span",[t._v("全选")])]),t._v(" "),c("div",{staticClass:"shopcart-accounts"},[c("span",[t._v("合计："),c("i",{domProps:{textContent:t._s("￥"+t.cartTotalPrice)}})]),t._v(" "),c("button",{class:{active:t.cartTotalPrice>0},on:{click:t.settleAccounts}},[t._v("结算")])])]):c("div",[t._m(0)]),t._v(" "),t._m(1),t._v(" "),c("div",{staticClass:"shopcart-recommend"},[c("div",{staticClass:"recommend-list"},t._l(t.recommendList,function(e,i){return c("div",{staticClass:"recommend-item",on:{click:function(e){t.productDetail(e,i)}}},[e.imageHost&&e.mainImage?c("img",{attrs:{src:e.imageHost+e.mainImage}}):c("img",{attrs:{src:a("dlqP")}}),t._v(" "),c("p",[t._v(t._s(e.name))]),t._v(" "),c("div",[c("span",{staticClass:"price"},[t._v("￥"+t._s(e.price))]),t._v(" "),c("i",{staticClass:"iconfont icon-gouwuche"})])])}))])]),t._v(" "),c("nav-bar")],1),t._v(" "),c("popup",{attrs:{"popup-title":t.popupTitle,"popup-show":t.popupShow},on:{cancelPopup:t.cancelPopup,confirmPopup:t.confirmPopup}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"shopcart-empty"},[e("img",{attrs:{src:"//img11.360buyimg.com/jdphoto/s180x180_jfs/t18163/292/540553659/74408/adeb7463/5a93c51cN3bb5e37b.png"}}),this._v(" "),e("p",[this._v("购物车空空如也，去逛逛吧~")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"recommend-title"},[e("span"),this._v(" "),e("i",[this._v("可能你还想要")]),this._v(" "),e("span")])}]};var g=a("VU/8")(m,v,!1,function(t){a("PfBz")},"data-v-6c7a06f0",null);e.default=g.exports},PfBz:function(t,e){}});
//# sourceMappingURL=12.09bc73742d0d4744d3af.js.map